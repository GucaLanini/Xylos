<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <title>Train</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
   <link href="css/style.css" rel="stylesheet" type="text/css"> 
</head>
<body>
    <div class="calendarbody padding-100">
        <div class="calendarheader"><p>Seleziona data e ora:</p></div>
        <div class="container-fluid calendar">
          <div class="row">
            <div class="col-7 border-right px-0">
              <div class="calendar-selector">
                <button id="prev-month">&lt;</button>
                <h3><span id="current-month"></span></h3>
                <button id="next-month">&gt;</button>
              </div>
              <div class="days" id="days-container"></div>
            </div>
          <div class="col-5 reset-padding">
            <div class="time-selector calendar-selector">
              <h3>Orario</h3>
            </div>
            <div class="time-options">
              <p class="time-option">8:00</p>
              <p class="time-option">9:00</p>
              <p class="time-option">10:00</p>
              <p class="time-option">11:00</p>
              <p class="time-option">12:00</p>
              <p class="time-option">13:00</p>
              <p class="time-option">14:00</p>
              <p class="time-option">15:00</p>
              <p class="time-option">16:00</p>
              <p class="time-option">17:00</p>
              <p class="time-option">18:00</p>
              <p class="time-option">19:00</p>
            </div>
          </div>
        </div>
    </div>
    </div>
    <div> 
        <a href="5.3.1_riepilogotrain.html" class="col-auto header-button justify-content-center body">
            <button type="button" class="btn btn-primary">Prenota</button>
        </a>
    </div>
</body>

<script>

/****CALENDARIO****/
document.addEventListener('DOMContentLoaded', () => {
    const currentMonthElement = document.getElementById('current-month');
    const daysContainer = document.getElementById('days-container');
    const prevMonthButton = document.getElementById('prev-month');
    const nextMonthButton = document.getElementById('next-month');

    let currentDate = new Date();
    let selectedDay = null;
    let selectedTime = null;

    function getMonthName(monthIndex) {
        const monthNames = [
            'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno',
            'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'
        ];
        return monthNames[monthIndex];
    }

    function generateCalendar(date) {
        const year = date.getFullYear();
        const month = date.getMonth();

        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        daysContainer.innerHTML = '';

        for (let i = 0; i < firstDay; i++) {
            const emptySlot = document.createElement('div');
            emptySlot.classList.add('day', 'empty');
            daysContainer.appendChild(emptySlot);
        }

        for (let day = 1; day <= daysInMonth; day++) {
            const dayElement = document.createElement('div');
            dayElement.classList.add('day');
            dayElement.textContent = day;

            dayElement.addEventListener('click', () => {
                if (selectedDay) {
                    selectedDay.classList.remove('selected');
                }
                dayElement.classList.add('selected');
                selectedDay = dayElement;
                saveSelection();
            });

            daysContainer.appendChild(dayElement);
        }

        currentMonthElement.textContent = `${getMonthName(month)} ${year}`;
    }

    prevMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        generateCalendar(currentDate);
    });

    nextMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        generateCalendar(currentDate);
    });

    /****SALVATAGGIO SELEZIONE****/
    function saveSelection() {
        const selectedDate = selectedDay ? selectedDay.textContent.trim() : null;
        const selectedMonth = getMonthName(currentDate.getMonth());
        const selectedYear = currentDate.getFullYear();
        const selectedHour = selectedTime ? selectedTime.textContent.trim() : null;

        if (selectedDate && selectedHour) {
            const selectedData = {
                date: `${selectedDate} ${selectedMonth} ${selectedYear}`,
                time: selectedHour
            };

            localStorage.setItem('selectedData', JSON.stringify(selectedData));

            console.log('Dati salvati:', selectedData);
        } else {
            console.warn('Seleziona sia una data che un orario.');
        }
    }

    const timeOptions = document.querySelectorAll('.time-option');
    timeOptions.forEach(time => {
        time.addEventListener('click', () => {
            if (selectedTime) {
                selectedTime.classList.remove('selected');
            }
            time.classList.add('selected');
            selectedTime = time;
            saveSelection();
        });
    });

    generateCalendar(currentDate);
});
</script>
</html>
